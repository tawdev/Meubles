# تعليمات استخدام نظام أنواع الفئات (Types Categories)

## الخطوات المطلوبة

### 1. إنشاء الجدول في قاعدة البيانات

قم بتنفيذ ملف SQL التالي في phpMyAdmin أو أي أداة إدارة قاعدة البيانات:

```sql
create_types_categories_table.sql
```

هذا الملف سيقوم بـ:
- إنشاء جدول `types_categories` المرتبط بجدول `categories`
- إضافة الأعمدة `category_id` و `type_category_id` إلى جدول `products`
- إدراج بعض أنواع الفئات كمثال

### 2. هيكل الجدول

#### جدول `types_categories`:
- `id`: المفتاح الأساسي
- `name`: اسم نوع الفئة
- `category_id`: المفتاح الأجنبي المرتبط بجدول `categories`
- `created_at`: تاريخ الإنشاء
- `updated_at`: تاريخ التحديث

#### جدول `products` (الأعمدة المضافة):
- `category_id`: المفتاح الأجنبي المرتبط بجدول `categories`
- `type_category_id`: المفتاح الأجنبي المرتبط بجدول `types_categories`

### 3. كيفية الاستخدام

#### عند إضافة منتج جديد:
1. اختر **الفئة** من القائمة المنسدلة الأولى
2. بعد اختيار الفئة، ستظهر قائمة منسدلة ثانية تحتوي على **أنواع الفئة** المرتبطة بها
3. اختر نوع الفئة (اختياري)
4. أكمل باقي البيانات واضغط "Ajouter le produit"

#### عند تعديل منتج:
1. ستظهر الفئة الحالية محملة تلقائياً
2. إذا كان المنتج له نوع فئة، سيظهر أيضاً محملاً
3. يمكنك تغيير الفئة، وسيتم تحديث قائمة أنواع الفئة تلقائياً

### 4. إضافة أنواع فئات جديدة

لإضافة أنواع فئات جديدة، يمكنك استخدام SQL:

```sql
INSERT INTO types_categories (name, category_id) 
VALUES ('Nom du type', ID_DE_LA_CATEGORIE);
```

أو يمكنك إنشاء صفحة إدارة في لوحة التحكم لإضافة/تعديل/حذف أنواع الفئات.

### 5. الملفات المعدلة

- `admin/add.php`: صفحة إضافة المنتجات
- `admin/edit.php`: صفحة تعديل المنتجات
- `admin/get_types_by_category.php`: API لتحميل أنواع الفئة عبر AJAX
- `create_types_categories_table.sql`: ملف SQL لإنشاء الجدول

### 6. ملاحظات مهمة

- النظام متوافق مع النظام القديم (حقل `category` لا يزال موجوداً للتوافق)
- حقل `type_category_id` اختياري - يمكن إضافة منتج بدون نوع فئة
- عند حذف فئة، سيتم حذف جميع أنواعها تلقائياً (CASCADE)
- عند حذف نوع فئة، سيتم تعيين `type_category_id` إلى NULL في المنتجات المرتبطة

